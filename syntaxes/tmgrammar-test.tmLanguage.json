{
	"$schema": "https://raw.githubusercontent.com/RedCMD/TmLanguage-Syntax-Highlighter/main/vscode.tmLanguage.schema.json",
	"comment": "https://github.com/PanAeon/vscode-tmgrammar-test",
	"name": "vscode-tmgrammar-test",
	"scopeName": "source.textmate.tmgrammar",
	"fileTypes": [ "snap" ],
	"patterns": [
		{ "include": "#SYNTAX_TEST" },
		{ "include": "#original_file" },
		{ "include": "#code-line" },
		{ "include": "#scope-line" },
		{
			"comment": "https://github.com/microsoft/vscode-textmate/issues/242",
			"include": "source.json.textmate#_pre-load_"
		}
	],
	"repository": {
		"SYNTAX_TEST": {
			"begin": "\\A(?!>\\S+)(\\S+)\\s+(SYNTAX\\s+TEST)(?>\\s+(\"(source\\.|text\\.)?([^\"]*)\")(?>\\s+(\"[^\"]*\"))?)?\\s*(.*)$",
			"while": "^(\\1)\\s*(\\^+(?:\\s*\\^+)*|<~*-+)|^(.*)$",
			"beginCaptures": {
				"0": { "name": "comment.line.tmgrammar" },
				"1": { "name": "comment.line.character.tmgrammar" },
				"2": { "name": "keyword.tmgrammar" },
				"3": { "name": "string.quoted.double.scopeName.tmgrammar" },
				"4": { "name": "support.function.tmgrammar" },
				"5": {
					"name": "string.quoted.double.scopeName.tmgrammar",
					"patterns": [
						{
							"match": "\\.",
							"name": "support.function.tmgrammar"
						},
						{
							"match": "\\b(?>comment|string|regex|meta\\.embedded)\\b",
							"name": "markup.italic"
						}
					]
				},
				"6": { "name": "string.quoted.name.tmgrammar" },
				"7": { "name": "invalid.tmgrammar" }
			},
			"whileCaptures": {
				"1": { "name": "comment.line.character.tmgrammar" },
				"2": { "name": "keyword.control.marker.tmgrammar" },
				"3": { "name": "string.other.code.tmgrammar" }
			},
			"patterns": [ { "include": "#scopes" } ]
		},
		"original_file": {
			"comment": "Used in https://github.com/microsoft/TypeScript-TmLanguage",
			"begin": "\\Aoriginal\\s+file(?=\\s*$)",
			"while": "^",
			"beginCaptures": { "0": { "name": "keyword.control.tmgrammar" } },
			"patterns": [
				{
					"begin": "^(-----------------------------------)\\s*$",
					"end": "^(-----------------------------------)\\s*$|^(?=[Gg]rammar:)",
					"captures": { "1": { "name": "markup.heading.original-file.tmgrammar" } },
					"patterns": [
						{
							"begin": "^",
							"while": "^(?!-----------------------------------\\s*$|[Gg]rammar:)",
							"name": "meta.embedded.typescript",
							"patterns": [
								{ "comment": "https://github.com/microsoft/vscode-textmate/blob/main/src/rule.ts#L559" },
								{ "include": "source.ts" }
							]
						}
					]
				},
				{
					"begin": "^([Gg]rammar:)\\s*(.+)$",
					"end": "^(-----------------------------------)\\s*$",
					"beginCaptures": {
						"1": { "name": "support.type.property-name.tmgrammar" },
						"2": { "name": "string.grammar-filename.tmgrammar" }
					},
					"endCaptures": { "1": { "name": "markup.heading.original-file.tmgrammar" } }
				},
				{
					"comment": "\"while\" will not allow the embedded language (TypeScript) to escape. (VSCode only)",
					"begin": "^>",
					"while": "(?!)",
					"beginCaptures": { "0": { "name": "keyword.control.marker.tmgrammar" } },
					"contentName": "meta.embedded.typescript",
					"patterns": [
						{ "comment": "https://github.com/microsoft/vscode-textmate/blob/main/src/rule.ts#L559" },
						{ "include": "source.ts" }
					]
				},
				{ "include": "#scope-line" }
			]
		},
		"code-line": {
			"begin": "^>",
			"end": "$",
			"beginCaptures": { "0": { "name": "keyword.control.marker.tmgrammar" } },
			"name": "meta.embedded.code.line",
			"contentName": "string.other.code.tmgrammar"
		},
		"scope-line": {
			"begin": "^(#)?\\s*(\\^+(?:\\s+\\^+)*|<~*-+)|^\\s+(?=[-\\w])",
			"end": "$",
			"beginCaptures": {
				"1": { "name": "comment.line.character.tmgrammar" },
				"2": { "name": "keyword.control.marker.tmgrammar" }
			},
			"patterns": [ { "include": "#scopes" } ]
		},
		"scopes": {
			"patterns": [
				{
					"match": "-",
					"name": "keyword.control.negate.tmgrammar"
				},
				{
					"match": "(?<=\\s)!(?=\\s)",
					"name": "keyword.control.negate.tmgrammar"
				},
				{
					"match": "[-$./:{}\\w]+",
					"captures": {
						"0": {
							"name": "$0",
							"patterns": [
								{
									"begin": "\\b(?>source|text)\\.",
									"end": "(?![-$./:{}\\w])",
									"beginCaptures": { "0": { "name": "support.function.tmgrammar" } },
									"name": "string.scopeName.tmgrammar",
									"patterns": [
										{
											"match": "\\.",
											"name": "support.function.tmgrammar"
										},
										{ "include": "source.json.textmate#name_scopes" }
									]
								},
								{ "include": "source.json.textmate#name_scopes" }
							]
						}
					}
				},
				{
					"match": "[^-$./:{}\\w\\s]+",
					"name": "invalid.illegal.tmgrammar"
				}
			]
		}
	}
}
